<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reaper Casino - Ultimate Texas Hold'em</title>
<style>
body {
    margin:0;
    font-family:"Segoe UI",Arial,sans-serif;
    background: linear-gradient(135deg,#0b0c10,#1f2833);
    color:white;
    min-height:100vh;
}

.topBar {
    position: fixed;
    top: 15px;
    right: 15px;
    display: flex;
    gap: 15px;
    background: rgba(0,0,0,0.5);
    padding: 8px 12px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.5);
    z-index: 2000;
}

.balanceDisplay {
    padding:6px 12px;
    border-radius:10px;
    background: rgba(255,255,255,0.15);
    color:white;
    font-weight:bold;
    font-size:1.1em;
}

.profileTab {
    padding:6px 12px;
    border-radius:10px;
    background: rgba(255,255,255,0.15);
    color:white;
    font-weight:bold;
    cursor:pointer;
    transition:0.2s;
}
.profileTab:hover { background: rgba(255,255,255,0.3); }

#addFundsBtn {
    position:fixed;
    right:15px;
    bottom:15px;
    padding:10px 20px;
    border:none;
    border-radius:10px;
    background:#28a745;
    color:white;
    font-weight:bold;
    cursor:pointer;
    box-shadow:0 3px 10px rgba(0,0,0,0.4);
    transition:0.2s;
}
#addFundsBtn:hover { background:#1e7e34; }

.main-container {
    display: flex;
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 15px;
    gap: 25px;
    flex-wrap: wrap;
}

.sidebar {
    width: 180px;
    flex-shrink: 0;
    margin-top: 100px;
}

.sidebar a {
    display: block;
    padding: 12px 16px;
    margin-bottom: 10px;
    border-radius: 10px;
    background: #444;
    color: white;
    text-decoration: none;
    font-weight: bold;
    font-size: 1.1em;
    text-align: center;
    transition: 0.2s;
}

.sidebar a:hover {
    background: #666;
    transform: translateX(4px);
}

header {
    padding:80px 15px 20px;
    text-align:center;
}

.welcome {
    font-size:48px;
    font-weight:bold;
    color:#ff4b2b;
    text-shadow: 2px 2px 15px rgba(255,75,43,0.6);
}
.welcome span { color:#ffb347; }

.topWrapper {
  display:flex;
  gap:20px;
  justify-content:flex-start;
  align-items:flex-start;
  flex-wrap:nowrap;
  width:100%;
}

.gameWrapper {
  flex:1 1 500px;
  background: rgba(0,0,0,0.5);
  padding: 15px;
  border-radius:15px;
  box-shadow:0 5px 15px rgba(0,0,0,0.6);
}

.bonusWrapper {
  flex:0 0 300px;
  display:flex;
  flex-direction:column;
  gap:15px;
}

.rulesWrapper {
  margin-top:20px;
  background: rgba(255,255,255,0.05);
  padding: 15px 20px;
  border-radius:12px;
  box-shadow:0 4px 10px rgba(0,0,0,0.4);
}

.rulesWrapper h2 { color: #ffb347; margin-bottom:10px; }
.rulesWrapper ul { list-style: disc; padding-left:20px; }
.rulesWrapper li { color:white; margin-bottom:6px; }

.bonusTable {
    flex:1;
    min-width:220px;
    background: rgba(255,255,255,0.05);
    border-radius:12px;
    padding:10px;
    margin:10px 0;
    box-shadow:0 4px 10px rgba(0,0,0,0.3);
}

.bonusTable h3 {
    text-align:center;
    margin-bottom:10px;
    font-size:1.2em;
    color:#ffb347;
    text-shadow:1px 1px 5px rgba(255,179,71,0.5);
}

.bonusTable table {
    width:100%;
    border-collapse:collapse;
}

.bonusTable th,
.bonusTable td {
    border:1px solid rgba(255,255,255,0.2);
    padding:8px;
    text-align:center;
    font-weight:bold;
    color:white;
}

.bonusTable th {
    background: rgba(255,255,255,0.1);
}

@media screen and (max-width:1024px) {
    .topWrapper { flex-direction:column; }
    .bonusWrapper { max-width:100%; margin-top:20px; }
    .sidebar {
        width:100%;
        display:flex;
        flex-wrap:wrap;
        justify-content:center;
        gap:10px;
        margin: 20px 0;
    }
    .sidebar a { margin-bottom:0; width:auto; padding:10px 20px; }
}

@media screen and (max-width:600px) {
    .card { width:55px; height:82px; }
    .card .corner { font-size:12px; padding:3px; }
    .card .center { font-size:28px; }
    input[type="number"] { width:100px; font-size:0.85em; padding:8px; }
}

/* –ö–Ω–æ–ø–∫–∏ ‚Äî –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å—Ç–æ–π –¥–∏–∑–∞–π–Ω */
button {
    font-size:1em;
    padding:10px;
    border-radius:10px;
    border:none;
    margin:5px;
    cursor:pointer;
    background:#555;
    color:white;
    font-weight:bold;
    transition:0.2s;
}
button:hover { background:#777; }

/* –ö–∞—Ä—Ç—ã ‚Äî –±–µ–∑ —Å–∫—Ä–æ–ª–ª–∞ */
.cardsContainer {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    gap: 6px;
    flex-wrap: nowrap;
    overflow-x: hidden;
    padding: 10px 0;
    max-width: 100%;
}

.card {
    width: 80px;
    height: 120px;
    border-radius: 12px;
    background: linear-gradient(145deg, #f8f9fa, #e9ecef);
    box-shadow: 0 8px 16px rgba(0,0,0,0.5), inset 0 2px 6px rgba(255,255,255,0.7);
    position: relative;
    overflow: hidden;
    transition: all 0.4s ease;
    opacity: 0;
    transform: translateY(30px) rotate(-5deg);
    flex-shrink: 1;
}

.card.show {
    opacity: 1;
    transform: translateY(0) rotate(0deg);
}

.card:hover {
    transform: translateY(-10px) scale(1.05);
    box-shadow: 0 20px 40px rgba(0,0,0,0.7), 0 0 25px rgba(255,215,0,0.5);
}

.card .corner {
    position: absolute;
    font-size: 18px;
    font-weight: bold;
    line-height: 1;
    padding: 6px;
}

.card .top-left { top: 4px; left: 4px; }
.card .bottom-right { bottom: 4px; right: 4px; transform: rotate(180deg); }

.card .center {
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 48px;
    font-weight: bold;
}

.card.red { color: #c62828; }
.card.black { color: #111; }

.card.back {
    background: linear-gradient(135deg, #1f2833 0%, #0b0c10 100%);
    box-shadow: 0 8px 16px rgba(0,0,0,0.7), inset 0 2px 8px rgba(255,75,43,0.15);
}

.card.back::before {
    content: "";
    position: absolute;
    inset: 10px;
    border: 2px solid rgba(255,75,43,0.3);
    border-radius: 8px;
    background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,75,43,0.05) 10px, rgba(255,75,43,0.05) 20px);
}

/* –ö–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–æ–¥ –∫–∞—Ä—Ç–∞–º–∏ */
#playerComboText, #botComboText {
    font-weight: bold;
    font-size: 1.5em;
    text-align: center;
    margin-top: 10px;
    min-height: 30px;
    color: white;
}

.win { color: #28a745 !important; }
.lose { color: #e53935 !important; }
.tie { color: #f39c12 !important; }

.bottomBalance {
    margin-top: 20px;
    font-size: 1.3em;
    background: linear-gradient(145deg,#1f2833,#0b0c10);
    box-shadow: 0 5px 15px rgba(0,0,0,0.6);
}

input[type="number"] {
    font-size:1em;
    padding:12px 15px;
    border-radius:12px;
    border:2px solid #555;
    background: linear-gradient(145deg, #1a1a1a, #0d0d0d);
    color:white;
    text-align:center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.5), inset 0 1px 2px rgba(255,255,255,0.05);
    transition: 0.3s;
    outline:none;
    width: 140px;
}
</style>
</head>
<body>

<div class="topBar">
    <div class="balanceDisplay">–ë–∞–ª–∞–Ω—Å: <span id="casinoBalance">10000</span></div>
    <div class="profileTab" onclick="toggleProfile()">–ü—Ä–æ—Ñ–∏–ª—å üìä</div>
</div>

<header>
    <div class="welcome">Reaper<span> Casino</span></div>
</header>

<div class="main-container">
    <div class="sidebar">
        <a href="blackjack.html">üÇ° Blackjack</a>
        <a href="roulette.html">üé° –†—É–ª–µ—Ç–∫–∞</a>
        <a href="index.html">üè† –ì–ª–∞–≤–Ω–∞—è</a>
    </div>

    <div class="topWrapper">
        <div class="gameWrapper">
            <div>
                <input type="number" id="bbBet" placeholder="BB –°—Ç–∞–≤–∫–∞" oninput="updateTotalBetDisplay()">
                <input type="number" id="anteBet" placeholder="Ante –°—Ç–∞–≤–∫–∞" oninput="updateTotalBetDisplay()">
                <input type="number" id="tripsBet" placeholder="TRIPS –°—Ç–∞–≤–∫–∞" oninput="updateTotalBetDisplay()">
                <input type="number" id="ultimateBet" placeholder="Ultimate –°—Ç–∞–≤–∫–∞" oninput="updateTotalBetDisplay()">
                <button id="startBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
            </div>

            <div class="cardsSection">
                <h3>–í–∞—à–∏ –∫–∞—Ä—Ç—ã</h3>
                <div class="cardsContainer" id="playerCards"></div>
                <p id="playerComboText"></p>
            </div>

            <div class="cardsSection">
                <h3>–ö–∞—Ä—Ç—ã –±–æ—Ç–∞</h3>
                <div class="cardsContainer" id="botCards"></div>
                <p id="botComboText"></p>
            </div>

            <div class="cardsSection">
                <h3>–ö–∞—Ä—Ç—ã –Ω–∞ —Å—Ç–æ–ª–µ</h3>
                <div class="cardsContainer" id="tableCards"></div>
            </div>

            <div id="actionButtons"></div>
            <p id="playerWinText"></p>
            <p id="totalBetDisplay">–û–±—â–∞—è —Å—Ç–∞–≤–∫–∞: 0</p>

            <div class="balanceDisplay bottomBalance">
                –ë–∞–ª–∞–Ω—Å: <span id="casinoBalanceBottom">10000</span>
            </div>
        </div>

        <div class="bonusWrapper">
            <div class="bonusTable">
                <h3>BB / TRIPS Bonus</h3>
                <table>
                    <tr><th>–ö–æ–º–±–∏–Ω–∞—Ü–∏—è</th><th>BB</th><th>TRIPS</th></tr>
                    <tr><td>–ù–∏–∂–µ</td><td>Push</td><td>3x</td></tr>
                    <tr><td>–°—Ç—Ä–∏—Ç</td><td>1x</td><td>5x</td></tr>
                    <tr><td>–§–ª–µ—à</td><td>1.5x</td><td>7x</td></tr>
                    <tr><td>–§—É–ª–ª-—Ö–∞—É—Å</td><td>3x</td><td>10x</td></tr>
                    <tr><td>–ö–∞—Ä–µ</td><td>10x</td><td>25x</td></tr>
                    <tr><td>–°—Ç—Ä–∏—Ç-—Ñ–ª–µ—à</td><td>50x</td><td>40x</td></tr>
                    <tr><td>–†–æ—è–ª-—Ñ–ª–µ—à</td><td>500x</td><td>70x</td></tr>
                </table>
            </div>

            <div class="bonusTable">
                <h3>Ultimate Bonus</h3>
                <table>
                    <tr><th>–ö–æ–º–±–∏–Ω–∞—Ü–∏—è</th><th>–í—ã–ø–ª–∞—Ç–∞</th></tr>
                    <tr><td>AA</td><td>30x</td></tr>
                    <tr><td>AK –æ–¥–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>25x</td></tr>
                    <tr><td>AQ –æ–¥–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>20x</td></tr>
                    <tr><td>AJ –æ–¥–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>15x</td></tr>
                    <tr><td>KK –∏–ª–∏ QQ –∏–ª–∏ JJ</td><td>15x</td></tr>
                    <tr><td>AK —Ä–∞–∑–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>10x</td></tr>
                    <tr><td>AQ —Ä–∞–∑–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>5x</td></tr>
                    <tr><td>AJ —Ä–∞–∑–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>2x</td></tr>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="rulesWrapper">
  <h2>–ü—Ä–∞–≤–∏–ª–∞ Ultimate Texas Hold'em</h2>
  <ul>
    <li>–°—Ç–∞–≤–∫–∏ BB –∏ Ante –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã.</li>
    <li>–ù–∞ –ø—Ä–µ—Ñ–ª–æ–ø–µ –º–æ–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å 4x –∏–ª–∏ —á–µ–∫.</li>
    <li>–ù–∞ —Ñ–ª–æ–ø–µ –º–æ–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å 2x –∏–ª–∏ —á–µ–∫.</li>
    <li>–ù–∞ —Ç–µ—Ä–Ω–µ –∏ —Ä–∏–≤–µ—Ä–µ –º–æ–∂–Ω–æ —Å—Ç–∞–≤–∏—Ç—å 1x –∏–ª–∏ —Å–∫–∏–Ω—É—Ç—å –∫–∞—Ä—Ç—ã.</li>
    <li>–í—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –∏–≥—Ä–æ–∫ —Å –ª—É—á—à–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–µ–π –ø–æ –ø–æ–∫–µ—Ä–Ω—ã–º –ø—Ä–∞–≤–∏–ª–∞–º.</li>
    <li>–ï—Å–ª–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ä–∞–≤–Ω—ã, —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ä—à–∞—è –∫–∞—Ä—Ç–∞ (–∫–∏–∫–µ—Ä).</li>
    <li>–ö–∞–∂–¥–∞—è –∏–≥—Ä–∞ –∏–º–µ–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç–∞–≤–∫—É 50, –µ—Å–ª–∏ –Ω–∞ —Ñ–ª–æ–ø–µ —É –≤–∞—Å –§—É–ª–ª-—Ö–∞—É—Å, —Ç–æ –∑–∞ —ç—Ç–æ –≤–∞–º –ø–ª–∞—Ç—è—Ç 300, –∑–∞ –∫–∞—Ä–µ 500, –∑–∞ –°—Ç—Ä–∏—Ç-—Ñ–ª–µ—à 3000, –∑–∞ –†–æ—è–ª-—Ñ–ª–µ—à 15000</li>
  </ul>
</div>

<button id="addFundsBtn">+10000</button>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è -->
<div id="profileModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center;">
    <div style="background:#1f2833; padding:30px; border-radius:15px; color:white; width:340px; max-width:90%; text-align:center; position:relative; box-shadow:0 10px 30px rgba(0,0,0,0.7);">
        <span onclick="toggleProfile()" style="position:absolute; top:12px; right:18px; font-size:28px; color:#ff4b2b; cursor:pointer;">‚úñ</span>
        <h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ –≤ –ü–æ–∫–µ—Ä–µ</h2>
        <p>–í—Å–µ–≥–æ –∏–≥—Ä: <span id="statGames">0</span></p>
        <p>–í—ã–∏–≥—Ä—ã—à–µ–π: <span id="statWins">0</span></p>
        <p>–ü—Ä–æ–∏–≥—Ä—ã—à–µ–π: <span id="statLosses">0</span></p>
        <p>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã–ø–ª–∞—Ç–∞: <span id="statMaxWin">0</span></p>
        <p>–õ—É—á—à–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è: <span id="statBestCombo">-</span></p>
        <button onclick="resetStats()" style="margin-top:20px; padding:12px 30px; background:#28a745; color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
    </div>
</div>

<script>
// –û–±—â–∏–π –±–∞–ª–∞–Ω—Å
let casinoBalance = localStorage.getItem("casinoBalance") 
    ? parseInt(localStorage.getItem("casinoBalance")) 
    : 10000;

function updateCasinoBalance() {
    document.getElementById("casinoBalance").innerText = casinoBalance;
    document.getElementById("casinoBalanceBottom").innerText = casinoBalance;
    localStorage.setItem("casinoBalance", casinoBalance);
}

// –ö–Ω–æ–ø–∫–∞ +10000
document.getElementById("addFundsBtn").onclick = () => {
    casinoBalance += 10000;
    updateCasinoBalance();
};

// –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–µ—Ä–∞
let pokerStats = localStorage.getItem("pokerStats") 
    ? JSON.parse(localStorage.getItem("pokerStats")) 
    : {games:0, wins:0, losses:0, maxWin:0, bestCombo:"-"};

function toggleProfile() {
    const modal = document.getElementById("profileModal");
    modal.style.display = modal.style.display === "flex" ? "none" : "flex";
    if (modal.style.display === "flex") {
        document.getElementById("statGames").innerText = pokerStats.games;
        document.getElementById("statWins").innerText = pokerStats.wins;
        document.getElementById("statLosses").innerText = pokerStats.losses;
        document.getElementById("statMaxWin").innerText = pokerStats.maxWin;
        document.getElementById("statBestCombo").innerText = pokerStats.bestCombo || "-";
    }
}

function resetStats() {
    if (!confirm("–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–∫–µ—Ä–∞?")) return;
    pokerStats = {games:0, wins:0, losses:0, maxWin:0, bestCombo:"-"};
    localStorage.setItem("pokerStats", JSON.stringify(pokerStats));
    toggleProfile();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—â–µ–π —Å—Ç–∞–≤–∫–∏
function updateTotalBetDisplay() {
    const bb = parseInt(document.getElementById("bbBet").value) || 0;
    const ante = parseInt(document.getElementById("anteBet").value) || 0;
    const trips = parseInt(document.getElementById("tripsBet").value) || 0;
    const ultimate = parseInt(document.getElementById("ultimateBet").value) || 0;
    const total = bb + ante + trips + ultimate + flopBonusBet + currentPlayBet;
    document.getElementById("totalBetDisplay").innerText = `–û–±—â–∞—è —Å—Ç–∞–≤–∫–∞: ${total}`;
}

document.querySelectorAll('input[type="number"]').forEach(input => {
    input.addEventListener('input', updateTotalBetDisplay);
});

// –¶–≤–µ—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π ‚Äî —Ç–æ–ª—å–∫–æ –≤ —à–æ—É–¥–∞—É–Ω
function updateComboColors(playerWins, tie) {
    const playerCombo = document.getElementById("playerComboText");
    const botCombo = document.getElementById("botComboText");
    playerCombo.className = "";
    botCombo.className = "";
    if (tie) {
        playerCombo.classList.add("tie");
        botCombo.classList.add("tie");
    } else if (playerWins) {
        playerCombo.classList.add("win");
        botCombo.classList.add("lose");
    } else {
        playerCombo.classList.add("lose");
        botCombo.classList.add("win");
    }
}

// –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –∏–≥—Ä—ã (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
window.onload = () => {
    updateCasinoBalance();
    updateTotalBetDisplay();
};

let deck = [], player = [], bot = [], table = [];
let bbBet = 0, anteBet = 0, tripsBet = 0, ultimateBet = 0;
let stage = "", currentPlayBet = 0;
const pokerSuits = ["‚ô†","‚ô•","‚ô¶","‚ô£"];
const pokerRanks = ["2","3","4","5","6","7","8","9","10","J","Q","K","A"];
const flopBonusBet = 50;

document.getElementById("startBtn").onclick = startPoker;

function createDeck(){
    let d = []; 
    for(let s of pokerSuits) for(let r of pokerRanks) d.push(r+s); 
    return d.sort(()=>Math.random()-0.5);
}
function deal(n){ return deck.splice(0,n); }

function displayCards(id, cards, highlightIndices=[]){
    const container = document.getElementById(id); container.innerHTML = "";
    cards.forEach((card,index)=>{
        const div = document.createElement("div"); div.classList.add("card");
        if(card==="üÇ†"){ 
            div.classList.add("back"); 
            container.appendChild(div); 
            setTimeout(() => div.classList.add("show"), 100 + index * 150);
            return; 
        }
        const rank = card.slice(0,-1), suit = card.slice(-1);
        if(suit==="‚ô•"||suit==="‚ô¶") div.classList.add("red"); else div.classList.add("black");
        div.innerHTML = `
            <div class="corner top-left">${rank}<br>${suit}</div>
            <div class="center">${suit}</div>
            <div class="corner bottom-right">${rank}<br>${suit}</div>
        `;
        if(highlightIndices.includes(index)) div.classList.add("highlight");
        container.appendChild(div);
        setTimeout(() => div.classList.add("show"), 100 + index * 150);
    });
}

function isDealerQualified(botCards, tableCards){
    const dealerEval = evaluateHand(botCards.concat(tableCards));
    return dealerEval.score >= 1;
}

function evaluateHand(cards){
    const values = cards.map(c=>pokerRanks.indexOf(c.slice(0,-1))).sort((a,b)=>b-a);
    const suits = cards.map(c=>c.slice(-1));
    const counts = {};
    values.forEach(v=>counts[v]=(counts[v]||0)+1);
    const pairs = Object.keys(counts).filter(k=>counts[k]===2).map(Number).sort((a,b)=>b-a);
    const three = Object.keys(counts).filter(k=>counts[k]===3).map(Number);
    const four = Object.keys(counts).filter(k=>counts[k]===4).map(Number);
    const flushSuit = suits.find(s=>suits.filter(x=>x===s).length>=5);
    const flushCards = flushSuit?cards.filter(c=>c.slice(-1)===flushSuit):[];
    const unique = [...new Set(values)].sort((a,b)=>b-a);
    function getStraight(vals){
        for(let i=0;i<=vals.length-5;i++){
            if(vals[i]-vals[i+4]===4) return vals[i];
        }
        if(vals.includes(12)&&vals.includes(3)&&vals.includes(2)&&vals.includes(1)&&vals.includes(0)) return 3;
        return null;
    }
    const straightHigh = getStraight(unique);
    let straightFlushHigh = null;
    if(flushSuit){
        const flushValues = [...new Set(flushCards.map(c=>pokerRanks.indexOf(c.slice(0,-1))))].sort((a,b)=>b-a);
        straightFlushHigh = getStraight(flushValues);
    }
    if(straightFlushHigh===12) return {score:9,name:"–†–æ—è–ª-—Ñ–ª–µ—à",ranks:[12]};
    if(straightFlushHigh!==null) return {score:8,name:"–°—Ç—Ä–∏—Ç-—Ñ–ª–µ—à",ranks:[straightFlushHigh]};
    if(four.length) return {score:7,name:"–ö–∞—Ä–µ",ranks:[four[0], ...values.filter(v=>v!==four[0])]};
    if(three.length && pairs.length) return {score:6,name:"–§—É–ª–ª-—Ö–∞—É—Å",ranks:[three[0], pairs[0]]};
    if(flushSuit) return {score:5,name:"–§–ª–µ—à",ranks:flushValues};
    if(straightHigh!==null) return {score:4,name:"–°—Ç—Ä–∏—Ç",ranks:[straightHigh]};
    if(three.length) return {score:3,name:"–°–µ—Ç",ranks:[three[0], ...values.filter(v=>v!==three[0])]};
    if(pairs.length>=2) return {score:2,name:"–î–≤–µ –ø–∞—Ä—ã",ranks:[pairs[0], pairs[1], ...values.filter(v=>v!==pairs[0]&&v!==pairs[1])]};
    if(pairs.length===1) return {score:1,name:"–ü–∞—Ä–∞",ranks:[pairs[0], ...values.filter(v=>v!==pairs[0])]};
    return {score:0,name:"–°—Ç–∞—Ä—à–∞—è –∫–∞—Ä—Ç–∞",ranks:values};
}

function compareHands(playerEval, botEval){
    if(playerEval.score>botEval.score) return 1;
    if(playerEval.score<botEval.score) return -1;
    for(let i=0;i<playerEval.ranks.length;i++){
        if(playerEval.ranks[i]>botEval.ranks[i]) return 1;
        if(playerEval.ranks[i]<botEval.ranks[i]) return -1;
    }
    return 0;
}

function showCurrentPlayerCombo(){
    const visibleCards = [...player];
    if(stage==="flop") visibleCards.push(...table.slice(0,3));
    else if(stage==="turn"||stage==="river"||stage==="showdown") visibleCards.push(...table);
    const currentEval = evaluateHand(visibleCards);
    const playerComboEl = document.getElementById("playerComboText");
    playerComboEl.innerText = currentEval.name;
    playerComboEl.style.color = "white"; // –≤—Å–µ–≥–¥–∞ –±–µ–ª—ã–π –¥–æ —à–æ—É–¥–∞—É–Ω–∞
}

function startPoker(){
    document.getElementById("playerWinText").innerText = "";
    document.getElementById("playerComboText").innerText = "";
    document.getElementById("botComboText").innerText = "";
    document.getElementById("actionButtons").innerHTML = "";
   
    bbBet = parseInt(document.getElementById("bbBet").value)||0;
    anteBet = parseInt(document.getElementById("anteBet").value)||0;
    tripsBet = parseInt(document.getElementById("tripsBet").value)||0;
    ultimateBet = parseInt(document.getElementById("ultimateBet").value)||0;
   
    if(bbBet!==anteBet || bbBet<=0){ alert("BB –∏ Ante –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã –∏ –±–æ–ª—å—à–µ 0"); return; }
    if(casinoBalance < (bbBet+anteBet+tripsBet+ultimateBet+flopBonusBet)){ alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤"); return; }

    casinoBalance -= (bbBet+anteBet+tripsBet+ultimateBet+flopBonusBet);
    updateCasinoBalance();
    updateTotalBetDisplay();

    deck = createDeck(); player = deal(2); bot = deal(2); table = deal(5);
    displayCards("playerCards", player); 
    displayCards("botCards", ["üÇ†","üÇ†"]); 
    displayCards("tableCards", []);
    stage = "preflop"; currentPlayBet = 0;

    showButtons("–ü—Ä–µ—Ñ–ª–æ–ø: 4x –∏–ª–∏ —á–µ–∫",4);
}

function showButtons(text,mult,allowFold=false,showCheck=true){
    const div = document.getElementById("actionButtons");
    div.innerHTML = `<p>${text}</p>`;
    if(mult>0){
        const btn = document.createElement("button");
        btn.innerText = `–°—Ç–∞–≤–∫–∞ ${mult}x`;
        btn.onclick = ()=>playerMove(mult);
        div.appendChild(btn);
    }
    if(showCheck){
        const btn = document.createElement("button");
        btn.innerText = "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å";
        btn.onclick = ()=>playerMove(0);
        div.appendChild(btn);
    }
    if(allowFold){
        const btn = document.createElement("button");
        btn.innerText = "–°–∫–∏–Ω—É—Ç—å –∫–∞—Ä—Ç—ã";
        btn.onclick = ()=>foldPoker();
        div.appendChild(btn);
    }
}

function playerMove(mult){
    if(mult>0){
        let stake = bbBet*mult;
        if(stake>casinoBalance){alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤"); return;}
        casinoBalance -= stake;
        updateCasinoBalance();
        currentPlayBet += stake;
        updateTotalBetDisplay();
    }
   
    if(stage==="preflop"){
        if(mult===4){ stage="showdown"; displayCards("tableCards",table); finishPoker(); return; }
        stage="flop";
        displayCards("tableCards", table.slice(0,3));
        showButtons("–§–ª–æ–ø: —Å—Ç–∞–≤–∫–∞ 2x –∏–ª–∏ —á–µ–∫",2,false,true);
        showCurrentPlayerCombo();
    }
    else if(stage==="flop"){
        if(mult===2){ stage="showdown"; displayCards("tableCards",table); finishPoker(); return; }
        stage="turn";
        displayCards("tableCards",table);
        showButtons("–¢–µ—Ä–Ω –∏ –†–∏–≤–µ—Ä: —Å—Ç–∞–≤–∫–∞ 1x –∏–ª–∏ —Å–∫–∏–Ω—É—Ç—å –∫–∞—Ä—Ç—ã",1,true,false);
        showCurrentPlayerCombo();
    }
    else if(stage==="turn"){
        stage="showdown";
        displayCards("tableCards",table);
        showCurrentPlayerCombo();
        finishPoker();
    }
}

function foldPoker() {
    displayCards("botCards", bot);
    const winText = document.getElementById("playerWinText");
    winText.style.color = "red";
    winText.innerText = "üò¢ –í—ã —Å–∫–∏–Ω—É–ª–∏ –∫–∞—Ä—Ç—ã. –°—Ç–∞–≤–∫–∏ –ø–æ—Ç–µ—Ä—è–Ω—ã.";
    setTimeout(showRestartButton, 300);
}

function finishPoker() {
    displayCards("botCards", bot);

    const playerEval = evaluateHand(player.concat(table));
    const botEval = evaluateHand(bot.concat(table));
    const cmp = compareHands(playerEval, botEval);

    document.getElementById("playerComboText").innerText = playerEval.name;
    document.getElementById("botComboText").innerText = botEval.name;

    updateComboColors(cmp === 1, cmp === 0);

    let totalWin = 0;
    let messages = [];

    const playerWins = cmp === 1;
    const tie = cmp === 0;

    if (tie) {
        totalWin += bbBet + anteBet + currentPlayBet;
        messages.push("–ü–£–®");
    } else if (playerWins) {
        let playWin = currentPlayBet * 2;
        totalWin += playWin;
        messages.push(`PLAY 1:1: ${playWin}`);

        let dealerQualified = isDealerQualified(bot, table);
        if (dealerQualified) {
            let anteWin = anteBet * 2;
            totalWin += anteWin;
            messages.push(`ANTE 1:1: ${anteWin}`);

            let blindMult = {
                "–°—Ç—Ä–∏—Ç":1, "–§–ª–µ—à":1.5, "–§—É–ª–ª-—Ö–∞—É—Å":3, "–ö–∞—Ä–µ":10,
                "–°—Ç—Ä–∏—Ç-—Ñ–ª–µ—à":50, "–†–æ—è–ª-—Ñ–ª–µ—à":500
            }[playerEval.name] || 0;
            if (blindMult > 0) {
                let blindWin = bbBet * (blindMult + 1);
                totalWin += blindWin;
                messages.push(`BLIND ${blindMult}: ${blindWin}`);
            }
        } else {
            totalWin += bbBet + anteBet;
            messages.push(`BLIND –∏ ANTE –ø—É—à (–¥–∏–ª–µ—Ä –Ω–µ –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω)`);
        }

        let tripsMult = {
            "–°–µ—Ç":3, "–°—Ç—Ä–∏—Ç":5, "–§–ª–µ—à":7, "–§—É–ª–ª-—Ö–∞—É—Å":10,
            "–ö–∞—Ä–µ":25, "–°—Ç—Ä–∏—Ç-—Ñ–ª–µ—à":40, "–†–æ—è–ª-—Ñ–ª–µ—à":70
        }[playerEval.name] || 0;
        if (tripsBet > 0 && tripsMult > 0) {
            let tripsWin = tripsBet * (tripsMult + 1);
            totalWin += tripsWin;
            messages.push(`TRIPS ${tripsMult}: ${tripsWin}`);
        }

        let ultMult = evaluateUltimate(player);
        if (ultimateBet > 0 && ultMult > 0) {
            let ultWin = ultimateBet * ultMult;
            totalWin += ultWin;
            messages.push(`ULTIMATE ${ultMult}: ${ultWin}`);
        }
    }

    casinoBalance += totalWin;
    updateCasinoBalance();

    const el = document.getElementById("playerWinText");
    el.style.transition = "color 0.5s ease";

    if (tie) {
        el.style.color = "#f39c12";
        el.innerText = `ü§ù –ù–∏—á—å—è | ${messages.join(" | ")}`;
    } else if (totalWin > 0) {
        el.style.color = "#28a745";
        el.innerText = `üéâ –í—ã–ø–ª–∞—Ç–∞: ${totalWin} | ${messages.join(" | ")}`;
    } else {
        el.style.color = "#e53935";
        el.innerText = `üò¢ –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏`;
    }

    pokerStats.games += 1;
    if (playerWins) pokerStats.wins += 1;
    else if (!tie) pokerStats.losses += 1;
    if (totalWin > pokerStats.maxWin) pokerStats.maxWin = totalWin;
    if (playerEval.name !== "–°—Ç–∞—Ä—à–∞—è –∫–∞—Ä—Ç–∞") pokerStats.bestCombo = playerEval.name;
    localStorage.setItem("pokerStats", JSON.stringify(pokerStats));

    setTimeout(showRestartButton, 300);
}

function evaluateUltimate(playerCards){
    const [c1,c2]=playerCards;
    const r1=c1.slice(0,-1), s1=c1.slice(-1);
    const r2=c2.slice(0,-1), s2=c2.slice(-1);

    if(r1==="A"&&r2==="A") return 30;
    if(r1===r2 && (r1==="K"||r1==="Q"||r1==="J")) return 15;
    if(((r1==="A"&&r2==="K")||(r1==="K"&&r2==="A")) && s1===s2) return 25;
    if(((r1==="A"&&r2==="Q")||(r1==="Q"&&r2==="A")) && s1===s2) return 20;
    if(((r1==="A"&&r2==="J")||(r1==="J"&&r2==="A")) && s1===s2) return 15;
    if((r1==="A"&&r2==="K")||(r1==="K"&&r2==="A")) return 10;
    if((r1==="A"&&r2==="Q")||(r1==="Q"&&r2==="A")) return 5;
    if((r1==="A"&&r2==="J")||(r1==="J"&&r2==="A")) return 2;
    return 0;
}

function showRestartButton() {
    const div = document.getElementById("actionButtons");
    div.innerHTML = "";
    const btn = document.createElement("button");
    btn.innerText = "–ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É";
    btn.onclick = () => {
        document.getElementById("playerWinText").innerText = "";
        document.getElementById("playerComboText").innerText = "";
        document.getElementById("botComboText").innerText = "";
        document.getElementById("playerCards").innerHTML = "";
        document.getElementById("botCards").innerHTML = "";
        document.getElementById("tableCards").innerHTML = "";
        startPoker();
    };
    div.appendChild(btn);
}
</script>
</body>
</html>
