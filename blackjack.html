<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Reaper Casino - Blackjack</title>
<style>
body {
    margin:0;
    font-family:"Segoe UI",Arial,sans-serif;
    background: linear-gradient(135deg,#0b0c10,#1f2833);
    color:white;
}
header {
    padding:15px;
    font-size:2em;
    text-align:center;
    color:#fff;
    font-weight:bold;
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:10px;
    position:relative;
}

.navBalanceWrapper {
    display:flex;
    width:100%;
    justify-content:space-between;
    align-items:flex-start;
    flex-wrap:wrap;
}

.navLinks {
    display:flex;
    flex-direction:column; /* –°—Ç–æ–ª–±–∏–∫ */
    gap:6px;
}

.navLinks a {
    display:block;
    padding:6px 12px; /* –º–µ–Ω—å—à–µ –∫–Ω–æ–ø–∫–∏ */
    border-radius:8px; /* —á—É—Ç—å –º–µ–Ω—å—à–µ –∑–∞–∫—Ä—É–≥–ª–µ–Ω–∏–µ */
    background: #555;
    color:white;
    text-decoration:none;
    font-weight:bold;
    text-align:center;
    font-size:0.9em; /* —É–º–µ–Ω—å—à–µ–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç */
    transition:0.2s;
}

.navLinks a:hover { background:#777; }

.balanceDisplay {
    padding:6px 12px;
    border-radius:10px;
    background: rgba(255,255,255,0.15);
    color:white;
    font-weight:bold;
    font-size:0.7em;
    text-align:center;
}
.bottomBalance {
    margin-top: 20px;
    font-size: 1.4em;
    font-weight: bold;
    background: linear-gradient(135deg, #0b0c10, #1f2833);
    padding: 10px 15px;
    border-radius: 12px;
    text-align: center;
    box-shadow: 0 6px 20px rgba(0,0,0,0.7);
    transition: 0.3s;
}
.bottomBalance:hover {
    box-shadow: 0 8px 25px rgba(0,0,0,0.8);
}
#addFundsBtn {
    position:fixed;
    right:15px;
    bottom:15px;
    padding:10px 20px;
    border:none;
    border-radius:10px;
    background:#28a745;
    color:white;
    font-weight:bold;
    cursor:pointer;
    box-shadow:0 3px 10px rgba(0,0,0,0.4);
    transition:0.2s;
}
#addFundsBtn:hover { background:#1e7e34; }

.container {
    display:flex;
    max-width:1000px;
    margin:20px auto 80px auto;
    gap:20px;
    flex-wrap:wrap;
    justify-content:center;
}

.gameArea {
    flex:2;
    min-width:280px;
    background: rgba(0,0,0,0.5);
    padding:20px;
    border-radius:15px;
    box-shadow:0 5px 15px rgba(0,0,0,0.6);
}

input[type="number"] {
    padding:10px;
    border-radius:12px;
    border:none;
    width:120px;
    font-size:1em;
    text-align:center;
    margin:5px;
}

.cardsContainer {
    display: flex;
    justify-content: center;
    gap: 12px;
    margin: 10px 0 20px 0;
    flex-wrap: wrap;
}

/* --- –°—Ç–∏–ª—å –∫–∞—Ä—Ç --- */
/* --- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å –∫–∞—Ä—Ç --- */
.card {
    width: 100px;
    height: 140px;
    border-radius: 16px;
    background: linear-gradient(145deg, #f0f0f5, #d6d6dc);
    box-shadow: 
        0 10px 25px rgba(0,0,0,0.6),
        inset 0 2px 6px rgba(255,255,255,0.8),
        inset 0 -4px 6px rgba(0,0,0,0.2);
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    font-weight: bold;
    font-size: 32px;
    transform-style: preserve-3d;
    cursor: pointer;
    opacity: 0;
    transform: translateY(-30px) scale(0.8);
    transition: all 0.4s ease;
}
.card.show {
    opacity: 1;
    transform: translateY(0) scale(1);
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø–µ—Ä–µ–±–æ—Ä–∞ */
.bust {
    animation: bustShake 0.5s ease;
}

@keyframes bustShake {
    0% { transform: translateX(0); }
    20% { transform: translateX(-10px); }
    40% { transform: translateX(10px); }
    60% { transform: translateX(-6px); }
    80% { transform: translateX(6px); }
    100% { transform: translateX(0); }
}

/* –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç –∫–∞—Ä—Ç—ã */
.flip {
    animation: flipCard 0.5s ease forwards;
}

@keyframes flipCard {
    0% { transform: rotateY(90deg); }
    100% { transform: rotateY(0deg); }
}
/* Hover —ç—Ñ—Ñ–µ–∫—Ç ‚Äî –ø–ª–∞–≤–Ω–æ–µ –≤—Ä–∞—â–µ–Ω–∏–µ –∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∞ */
.card:hover {
    transform: rotateY(15deg) rotateX(7deg) scale(1.1);
    box-shadow: 
        0 20px 40px rgba(0,0,0,0.8),
        0 0 30px rgba(255,75,43,0.5),
        inset 0 0 15px rgba(255,255,255,0.2);
}

/* –ö—Ä–∞—Å–Ω—ã–µ –∏ —á–µ—Ä–Ω—ã–µ –º–∞—Å—Ç–∏ */
.card.red { color: #e53935; text-shadow: 0 1px 2px rgba(0,0,0,0.4); }
.card.black { color: #111; text-shadow: 0 1px 2px rgba(255,255,255,0.2); }

/* –£–≥–ª—ã –∫–∞—Ä—Ç—ã */
.card .corner {
    position: absolute;
    font-size: 16px;
    line-height: 1;
    text-align: center;
}
.card .top-left { top: 8px; left: 8px; }
.card .bottom-right { bottom: 8px; right: 8px; transform: rotate(180deg); }

/* –¶–µ–Ω—Ç—Ä –∫–∞—Ä—Ç—ã */
.card .center {
    font-size: 48px;
    text-shadow: 2px 2px 6px rgba(0,0,0,0.5);
}

/* –†—É–±–∞—à–∫–∞ –∫–∞—Ä—Ç—ã */
.card.back {
    background: linear-gradient(135deg, #1b1f26, #0b0c10);
    color: #ff4b2b;
    box-shadow:
        0 10px 25px rgba(0,0,0,0.8),
        inset 0 0 30px rgba(255,75,43,0.3);
}
.card.back::before {
    content: "‚òÖ";
    font-size: 60px;
    opacity: 0.6;
}

/* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≤—ã–∏–≥—Ä—ã—à–Ω–æ–π –∫–∞—Ä—Ç—ã */
.card.highlight {
    box-shadow:
        0 0 15px 5px #ffd700,
        0 0 35px 10px rgba(255,215,0,0.4),
        inset 0 0 10px rgba(255,255,255,0.2);
    transform: rotateY(20deg) rotateX(10deg) scale(1.12);
    transition: all 0.5s ease;
}

button {
    cursor:pointer;
    background:#555;
    color:white;
    font-weight:bold;
    padding:10px 18px;
    border-radius:12px;
    border:none;
    margin:5px;
    box-shadow:0 3px 10px rgba(0,0,0,0.4);
    transition:0.2s;
}
button:hover { background:#777; }

#bjGameResult { margin-top:10px; font-size:1.3em; font-weight:bold; }

.bonusTable {
    flex:1;
    min-width:220px;
    background: rgba(255,255,255,0.05);
    border-radius:12px;
    padding:10px;
    overflow-x:auto;
}
.bonusTable h3 { text-align:center; margin-bottom:10px; }
.bonusTable table { width:100%; border-collapse:collapse; }
.bonusTable th, .bonusTable td { border:1px solid rgba(255,255,255,0.2); padding:8px; text-align:center; }
.bonusTable th { background:rgba(255,255,255,0.1); }

@media screen and (max-width:768px){
    header { font-size:1.5em; }
    .card { width:60px; height:90px; font-size:1em; }
    input[type="number"] { width:100px; }
    .container { flex-direction:column; align-items:center; }
    #addFundsBtn { padding:8px 16px; font-size:0.9em; }
    .navLinks a { padding:5px 10px; font-size:0.85em; }
}
@media screen and (max-width:480px){
    header { font-size:1.2em; }
    .card { width:45px; height:65px; font-size:0.9em; }
    .navLinks a { padding:4px 8px; font-size:0.8em; }
    input[type="number"] { width:80px; font-size:0.9em; }
    header { font-size:1.2em; }
    #addFundsBtn { padding:6px 12px; font-size:0.8em;right:10px; bottom:60px;  }
    .bonusTable { min-width:180px; font-size:0.85em; }
}
.welcome {
    text-align:center;
    font-size:48px;
    font-weight:bold;
    color:#ff4b2b;
    text-shadow: 2px 2px 15px rgba(255,75,43,0.6), 0 0 20px rgba(255,75,43,0.4);
}
.welcome span {
    color:#ffb347;
    text-shadow: 2px 2px 20px rgba(255,179,71,0.5);
}
/* --- BLACKJACK WIN ANIMATION --- */

.blackjackWin {
    animation: blackjackGlow 1s ease-in-out infinite alternate;
}

@keyframes blackjackGlow {
    from {
        box-shadow: 0 0 20px gold;
        transform: scale(1);
    }
    to {
        box-shadow: 0 0 50px gold;
        transform: scale(1.08);
    }
}

.bjBanner {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 48px;
    font-weight: bold;
    color: gold;
    text-shadow: 0 0 20px orange, 0 0 40px gold;
    animation: bannerPop 0.8s ease forwards;
    pointer-events: none;
}

@keyframes bannerPop {
    0% { transform: translate(-50%, -50%) scale(0); opacity:0; }
    70% { transform: translate(-50%, -50%) scale(1.2); }
    100% { transform: translate(-50%, -50%) scale(1); opacity:1; }
}
.betRow {
    display: flex;
    align-items: flex-end; /* —á—Ç–æ–±—ã –∫–Ω–æ–ø–∫–∞ –±—ã–ª–∞ –Ω–∞ –æ–¥–Ω–æ–π –ª–∏–Ω–∏–∏ —Å input */
    gap: 10px;
    margin-bottom: 15px;
    flex-wrap: wrap; /* —á—Ç–æ–±—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–Ω–æ—Å–∏–ª–æ—Å—å */
}

.betWrapper {
    display: flex;
    flex-direction: column; /* –Ω–∞–¥–ø–∏—Å—å –Ω–∞–¥ input */
    align-items: center;
}

.betLabel {
    font-weight: bold;
    margin-bottom: 5px;
    color: #ffb347;
    font-size: 0.9em;
}


</style>
</head>
<body>

<header>
    
<div class="welcome">Reaper<span> Casino</span></div>
    üÇ° Blackjack
    <div class="navBalanceWrapper">
        <div class="navLinks">
            <a href="roulette.html">üé° –†—É–ª–µ—Ç–∫–∞</a>
            <a href="poker.html">üÉè –ü–æ–∫–µ—Ä</a>
            <a href="index.html">üè† –ì–ª–∞–≤–Ω–∞—è</a>
        </div>
        <div class="balanceDisplay">–ë–∞–ª–∞–Ω—Å: <span id="bjBalance">10000</span></div>
    </div>
</header>

<div class="container">
    <div class="bonusTable">
        <h3>Ultimate Bonus</h3>
        <table>
            <tr><th>–ö–æ–º–±–∏–Ω–∞—Ü–∏—è</th><th>–í—ã–ø–ª–∞—Ç–∞</th></tr>
            <tr><td>7‚ô¶ 7‚ô¶ + 7‚ô¶ —É –¥–∏–ª–µ—Ä–∞</td><td>1000x</td></tr>
            <tr><td>K‚ô†K‚ô† + BJ –¥–∏–ª–µ—Ä–∞</td><td>1000x</td></tr>
            <tr><td>K‚ô†K‚ô†</td><td>100x</td></tr>
            <tr><td>‚ô†7 ‚ô£7 ‚ô¶7 (—Ä–∞–∑–Ω—ã–µ –º–∞—Å—Ç–∏)</td><td>50x</td></tr>
            <tr><td>KK –æ–¥–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>30x</td></tr>
            <tr><td>QQ –æ–¥–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>25x</td></tr>
            <tr><td>JJ –æ–¥–Ω–æ–º–∞—Å—Ç–Ω—ã–µ</td><td>25x</td></tr>
        </table>
    </div>
    <div class="gameArea">
    <div class="betRow">
        <div class="betWrapper">
            <div class="betLabel">–û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞–≤–∫–∞:</div>
            <input type="number" id="bjBet" placeholder="–°—Ç–∞–≤–∫–∞">
        </div>
        <div class="betWrapper">
            <div class="betLabel">Ultimate Bet:</div>
            <input type="number" id="bjUltimateBet" placeholder="Ultimate Bet">
        </div>
        <button onclick="startBJ()">–ò–≥—Ä–∞—Ç—å</button>
    </div>

    <div id="deckMessage" style="margin-top:10px; color:#ffb347; font-weight:bold;"></div>

    <div>
        <h3>–í–∞—à–∏ –∫–∞—Ä—Ç—ã <span id="bjPlayerTotal">–°—É–º–º–∞: 0</span></h3>
        <div class="cardsContainer" id="bjPlayerCards"></div>
    </div>

    <div>
        <h3>–ö–∞—Ä—Ç—ã –¥–∏–ª–µ—Ä–∞ <span id="bjDealerTotal">–°—É–º–º–∞: ?</span></h3>
        <div class="cardsContainer" id="bjDealerCards"></div>
    </div>

    <div id="bjActionButtons"></div>
    <div id="bjGameResult"></div>
    <div class="bottomBalance">
        –í–∞—à –±–∞–ª–∞–Ω—Å: <span id="bjBalanceBottom">10000</span>
    </div>
</div>

</div>

<button id="addFundsBtn">+10000</button>

<script>
let bjBalance = 10000;
let bjDeck = [];
let bjHands = [];
let bjDealer = [];
let gameOver = true;
let currentWin = 0;

const suits = ["‚ô†", "‚ô•", "‚ô¶", "‚ô£"];
const ranks = ["2","3","4","5","6","7","8","9","10","J","Q","K","A"];

// DOM —Å—Å—ã–ª–∫–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
const bjPlayerCardsEl = document.getElementById("bjPlayerCards");
const bjDealerCardsEl = document.getElementById("bjDealerCards");
const bjGameResultEl = document.getElementById("bjGameResult");

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–ª–æ–¥—ã (3 –∫–æ–ª–æ–¥—ã)
function createDeck() {
    let deck = [];
    for(let i=0;i<3;i++){
        for(let s of suits){
            for(let r of ranks){
                deck.push({rank: r, suit: s});
            }
        }
    }
    return deck.sort(() => Math.random() - 0.5);
}

// –í—ã—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã
function deal() {
    const deckMessageEl = document.getElementById("deckMessage");

    if(bjDeck.length < 20){
        bjDeck = createDeck();
        deckMessageEl.innerText = "üÉè –ö–æ–ª–æ–¥–∞ –ø–µ—Ä–µ–º–µ—à–∞–Ω–∞!";
        setTimeout(() => { deckMessageEl.innerText = ""; }, 2000);
    }
    return bjDeck.pop();
}



// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
function updateBalance() {
    document.getElementById("bjBalance").innerText = bjBalance;
    document.getElementById("bjBalanceBottom").innerText = bjBalance;
}

// –ó–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã
function cardValue(card) {
    if(card.rank === "A") return 11;
    if(["K","Q","J"].includes(card.rank)) return 10;
    return parseInt(card.rank);
}

// –°—É–º–º–∞ –∫–∞—Ä—Ç —Å —É—á–µ—Ç–æ–º —Ç—É–∑–æ–≤
function getTotal(cards){
    let total=0, aces=0;
    cards.forEach(c=>{
        total += cardValue(c);
        if(c.rank === "A") aces++;
    });
    while(total>21 && aces>0){
        total -= 10;
        aces--;
    }
    return total;
}

// –û—á–∏—Å—Ç–∫–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
function clearBoard() {
    bjPlayerCardsEl.innerHTML = "";
    bjDealerCardsEl.innerHTML = "";
}

// –°–æ–∑–¥–∞–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–∞—Ä—Ç—ã
function createCardElement(card, hidden=false) {
    const cardEl = document.createElement("div");
    cardEl.className = "card";

    if(hidden){
        cardEl.classList.add("back");
        cardEl.textContent = "";
    } else {
        cardEl.textContent = card.rank + card.suit;
        if(card.suit === "‚ô•" || card.suit === "‚ô¶"){
            cardEl.classList.add("red");
        } else {
            cardEl.classList.add("black");
        }
    }
    return cardEl;
}

// –†–∞–∑–¥–∞—á–∞ –∫–∞—Ä—Ç—ã –∏–≥—Ä–æ–∫—É
async function dealCardToPlayer() {
    let card = deal();
    bjHands[0].cards.push(card);

    const cardEl = createCardElement(card);
    bjPlayerCardsEl.appendChild(cardEl);

    await sleep(50);
    cardEl.classList.add("show");
    cardEl.classList.add("flip");

    updateTotals();
}

// –†–∞–∑–¥–∞—á–∞ –∫–∞—Ä—Ç—ã –¥–∏–ª–µ—Ä—É
async function dealCardToDealer(hide=false) {
    let card = deal();
    bjDealer.push(card);

    const cardEl = createCardElement(card, hide && bjDealer.length === 2);
    bjDealerCardsEl.appendChild(cardEl);

    await sleep(50);
    cardEl.classList.add("show");
    cardEl.classList.add("flip");

    updateTotals();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É–º–º—ã –∫–∞—Ä—Ç
function updateTotals() {
    document.getElementById("bjPlayerTotal").innerText = "–°—É–º–º–∞: " + getTotal(bjHands[0].cards);

    if(gameOver){
        document.getElementById("bjDealerTotal").innerText = "–°—É–º–º–∞: " + getTotal(bjDealer);
    } else {
        let firstCardValue = bjDealer.length > 0 ? cardValue(bjDealer[0]) : 0;
        document.getElementById("bjDealerTotal").innerText = "–°—É–º–º–∞: " + firstCardValue;
    }
}

// –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã
async function startBJ(){
    let bet = parseInt(document.getElementById("bjBet").value) || 0;
    let ultimateBet = parseInt(document.getElementById("bjUltimateBet").value) || 0;

    if(!Number.isInteger(bet) || bet <= 0 || bet > bjBalance){
        alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É");
        return;
    }
    if(!Number.isInteger(ultimateBet) || ultimateBet < 0 || ultimateBet > bjBalance){
        alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É –¥–ª—è Ultimate Bonus");
        return;
    }

    bjBalance -= bet + ultimateBet;
    updateBalance();

    bjHands = [{cards:[], bet:bet, ultimateBet: ultimateBet, doubled:false}];
    bjDealer = [];
    gameOver = false;
    currentWin = 0;

    bjGameResultEl.innerText = "";
    document.getElementById("bjActionButtons").innerHTML = "";
    clearBoard();

    // –†–∞–∑–¥–∞—á–∞ –∫–∞—Ä—Ç
    await dealCardToPlayer();
    await sleep(500);
    await dealCardToDealer(true);
    await sleep(500);
    await dealCardToPlayer();
    await sleep(500);
    await dealCardToDealer(true);

    updateTotals();

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ Blackjack
    if(getTotal(bjHands[0].cards) === 21){
        await sleep(500);

        revealDealerCards();
        gameOver = true;
        updateTotals();

        await sleep(500);

        let win = bet * 2.5;
        bjBalance += win;
        updateBalance();

        await playBlackjackAnimation();

        bjGameResultEl.innerText = `üéâ Blackjack! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${win}`;

        endGame();
        return;
    }

    showButtons();
}

// –ü–æ–∫–∞–∑ –∫–Ω–æ–ø–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π
function showButtons(){
    document.getElementById("bjActionButtons").innerHTML = `
        <button style="background:#2ecc71" onclick="hit()">–í–∑—è—Ç—å</button>
        <button style="background:#3498db" onclick="stand()">–°—Ç–æ–ø</button>
        <button style="background:#f39c12" onclick="doubleBet()">–£–¥–≤–æ–∏—Ç—å</button>
    `;
}

// –í–∑—è—Ç—å –∫–∞—Ä—Ç—É
async function hit(){
    await dealCardToPlayer();
    let total = getTotal(bjHands[0].cards);

    if(total > 21){
        bjPlayerCardsEl.classList.add("bust");
        bjGameResultEl.innerText = "‚ùå –ü–µ—Ä–µ–±–æ—Ä!";
        document.getElementById("bjActionButtons").innerHTML = "";

        await sleep(500);
        revealDealerCards();
        gameOver = true;
        updateTotals();
        await sleep(500);

        finishRound();

        setTimeout(() => { bjPlayerCardsEl.classList.remove("bust"); }, 600);
    } else if(total === 21){
        document.getElementById("bjActionButtons").innerHTML = "";
        await stand();
    }
}

// –°—Ç–æ–ø
async function stand(){
    document.getElementById("bjActionButtons").innerHTML = "";
    gameOver = true;

    revealDealerCards();
    updateTotals();
    await sleep(500);

    while(getTotal(bjDealer)<17){
        await dealCardToDealer(false);
        await sleep(500);
    }

    finishRound();
}

// –£–¥–≤–æ–∏—Ç—å —Å—Ç–∞–≤–∫—É
async function doubleBet(){
    let hand = bjHands[0];
    if(hand.doubled) return;
    if(bjBalance < hand.bet){ alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤"); return; }

    bjBalance -= hand.bet;
    hand.bet *= 2;
    hand.doubled = true;
    updateBalance();

    document.getElementById("bjActionButtons").innerHTML = "";
    await dealCardToPlayer();

    if(getTotal(hand.cards) <= 21){
        await stand();
    } else {
        bjGameResultEl.innerText = "‚ùå –ü–µ—Ä–µ–±–æ—Ä!";
        endGame();
    }
}

// Reveal –∫–∞—Ä—Ç—ã –¥–∏–ª–µ—Ä–∞
function revealDealerCards(){
    const dealerCards = document.querySelectorAll("#bjDealerCards .card");
    dealerCards.forEach((cardEl, i)=>{
        cardEl.classList.remove("back");
        cardEl.textContent = bjDealer[i].rank + bjDealer[i].suit;
        if(bjDealer[i].suit==="‚ô•"||bjDealer[i].suit==="‚ô¶") cardEl.classList.add("red");
        else cardEl.classList.add("black");
        cardEl.classList.add("flip");
    });
}

// Ultimate Bonus
function calculateUltimateBonus(hand, dealerCards){
    let uBet = hand.ultimateBet;
    if(uBet <= 0) return 0;
    if(hand.cards.length !== 2) return 0;

    let c1 = hand.cards[0];
    let c2 = hand.cards[1];

    let dealerBJ = dealerCards.length === 2 && getTotal(dealerCards) === 21;

    if(c1.rank==="7" && c2.rank==="7" && c1.suit==="‚ô¶" && c2.suit==="‚ô¶" &&
       dealerCards.some(c=>c.rank==="7" && c.suit==="‚ô¶")) return uBet*1000;
    if(c1.rank==="K" && c2.rank==="K" && c1.suit==="‚ô†" && c2.suit==="‚ô†" && dealerBJ) return uBet*1000;
    if(c1.rank==="K" && c2.rank==="K" && c1.suit==="‚ô†" && c2.suit==="‚ô†") return uBet*100;
    if(c1.rank==="7" && c2.rank==="7"){
        dealerCards.filter(c=>c.rank==="7").forEach(d=>{
            let suitsSet = new Set([c1.suit, c2.suit, d.suit]);
            if(suitsSet.size===3) uBet*50;
        });
    }
    if(c1.rank==="K" && c2.rank==="K" && c1.suit===c2.suit) return uBet*30;
    if(c1.rank==="Q" && c2.rank==="Q" && c1.suit===c2.suit) return uBet*25;
    if(c1.rank==="J" && c2.rank==="J" && c1.suit===c2.suit) return uBet*25;
    return 0;
}

// –ê–Ω–∏–º–∞—Ü–∏—è Blackjack
async function playBlackjackAnimation(){
    const playerCards = document.querySelectorAll("#bjPlayerCards .card");
    playerCards.forEach(card=> card.classList.add("blackjackWin"));

    const banner = document.createElement("div");
    banner.className = "bjBanner";
    banner.innerText = "BLACKJACK!";
    document.body.appendChild(banner);

    await sleep(1500);

    banner.remove();
    playerCards.forEach(card=> card.classList.remove("blackjackWin"));
}

// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞—É–Ω–¥–∞
function finishRound(){
    let hand = bjHands[0];
    let playerTotal = getTotal(hand.cards);
    let dealerTotal = getTotal(bjDealer);
    let result = "";
    currentWin = 0;

    if(playerTotal>21) result="–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏";
    else if(dealerTotal>21 || playerTotal>dealerTotal){
        currentWin = hand.bet*2;
        bjBalance += currentWin;
        result=`–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${currentWin}`;
    } else if(playerTotal===dealerTotal){
        currentWin = hand.bet;
        bjBalance += currentWin;
        result='–ù–∏—á—å—è';
    } else result="–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏";

    let bonusWin = calculateUltimateBonus(hand, bjDealer);
    if(bonusWin > 0){
        bjBalance += bonusWin;
        result += ` + Ultimate Bonus ${bonusWin} üé∞`;
    }

    updateBalance();
    bjGameResultEl.innerText = result;
    endGame();
}

// –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
function endGame(){
    document.getElementById("bjActionButtons").innerHTML = `<button style="background:green" onclick="startBJ()">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>`;
}

// –î–æ–±–∞–≤–∏—Ç—å –¥–µ–Ω—å–≥–∏
document.getElementById("addFundsBtn").onclick = ()=>{
    bjBalance += 10000;
    updateBalance();
}

// Sleep
function sleep(ms){ return new Promise(resolve=>setTimeout(resolve, ms)); }

bjDeck = createDeck();
updateBalance();
</script>


</body>
</html>
